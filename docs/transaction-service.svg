<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="932px" preserveAspectRatio="none" style="width:2042px;height:932px;" version="1.1" viewBox="0 0 2042 932" width="2042px" zoomAndPan="magnify"><defs/><g><!--MD5=[979c31051cf8d07bdf927ed864b836ec]
entity cl--><ellipse cx="74" cy="57" fill="#FFFFFF" rx="16" ry="16" style="stroke: #A80036; stroke-width: 4.0;"/><path d="M74,73 L74,127 M48,89 L100,89 M74,127 L48,157 M74,127 L100,157 " fill="none" style="stroke: #A80036; stroke-width: 4.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="124" x="12" y="211.2422">client</text><!--MD5=[edc2c29f12934937e9dee71e2d189b28]
entity tr--><path d="M1479,91 C1479,71 1628,71 1628,71 C1628,71 1777,71 1777,91 L1777,169.9375 C1777,189.9375 1628,189.9375 1628,189.9375 C1628,189.9375 1479,189.9375 1479,169.9375 L1479,91 " fill="#ADD8E6" style="stroke: #000000; stroke-width: 3.0;"/><path d="M1479,91 C1479,111 1628,111 1628,111 C1628,111 1777,111 1777,91 " fill="none" style="stroke: #000000; stroke-width: 3.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="258" x="1499" y="167.2422">transaction</text><!--MD5=[8e9b2d9d80e066cced8e5d90e9bdea61]
entity c--><rect fill="#FFFF00" height="100.9375" style="stroke: #A80036; stroke-width: 3.0;" width="272" x="1122" y="467"/><rect fill="#FFFF00" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="1112" y="477"/><rect fill="#FFFF00" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="1112" y="547.9375"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="232" x="1142" y="535.2422">consumer</text><!--MD5=[99db986d38fb499b252ed01955165f04]
entity kc--><rect fill="#D3D3D3" height="100.9375" style="stroke: #A80036; stroke-width: 3.0;" width="166" x="1175" y="811"/><rect fill="#D3D3D3" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="1165" y="821"/><rect fill="#D3D3D3" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="1165" y="891.9375"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="126" x="1195" y="879.2422">kafka</text><!--MD5=[694f580618a8ff0a20e3fd904d058a88]
entity sp--><rect fill="#FFFF00" height="100.9375" style="stroke: #A80036; stroke-width: 3.0;" width="430" x="677" y="80"/><rect fill="#FFFF00" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="667" y="90"/><rect fill="#FFFF00" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="667" y="160.9375"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="390" x="697" y="148.2422">schema-provider</text><!--MD5=[ce416eb35adc1d8056c0af1bbec5e02c]
link cl to sp--><path d="M146.4682,130 C261.7354,130 491.6048,130 665.7886,130 " fill="none" id="cl-sp" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="676.1304,130,658.1304,122,666.1304,130,658.1304,138,676.1304,130" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="136.1544,130,154.1544,138,146.1544,130,154.1544,122,136.1544,130" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="468" x="172.5" y="50.2422">queries or subscribe</text><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="342" x="172.5" y="111.1797">to transactions</text><!--MD5=[eb3f1ccace7a0c782314adb87c475fa5]
link sp to tr--><path d="M1107.8512,130 C1223.317,130 1363.0376,130 1468.5818,130 " fill="none" id="sp-&gt;tr" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1478.6872,130,1460.6872,122,1468.6872,130,1460.6872,138,1478.6872,130" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="278" x="1144" y="50.2422">sql query on</text><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="298" x="1144" y="111.1797">derived state</text><!--MD5=[ceaf0cd2ce4ad636a55921864d5ee2bc]
reverse link tr to c--><path d="M1616.6716,199.6666 C1603.3238,261.2982 1575.5102,350.0424 1520,407 C1485.9128,441.976 1439.0074,466.3508 1394.2958,483.0932 " fill="none" id="tr&lt;-c" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1618.8454,189.254,1607.3355,205.2391,1616.8017,199.0429,1622.9978,208.5091,1618.8454,189.254" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="424" x="1594" y="363.2422">insert transactions</text><!--MD5=[55cb83ca2a74855f56e7a3dc1128cf48]
reverse link c to kc--><path d="M1258,577.3168 C1258,643.6364 1258,748.9828 1258,810.919 " fill="none" id="c&lt;-kc" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1258,567.0206,1250,585.0206,1258,577.0206,1266,585.0206,1258,567.0206" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="240" x="1335" y="677.2422">consumes</text><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="390" x="1260" y="738.1797">BalanceChanged</text><!--MD5=[a9e274f941e496d3d2b249e342953251]
link c to sp--><path d="M1121.8332,492.6718 C1067.9322,476.6506 1009.5278,450.2714 970,407 C915.5314,347.3728 898.7502,252.6034 893.7792,190.8462 " fill="none" id="c-&gt;sp" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="893.0302,180.4728,886.348,199.0025,893.7508,190.4468,902.3064,197.8496,893.0302,180.4728" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="382" x="1050" y="333.2422">send transaction</text><text fill="#000000" font-family="Roboto" font-size="52" lengthAdjust="spacingAndGlyphs" textLength="538" x="972" y="394.1797">for active subscriptions</text><!--MD5=[be17cc081c67aea9834277b46636bead]
@startuml
skinparam shadowing false
skinparam defaultFontName Roboto
skinparam defaultFontSize 26

actor client as cl #White
database transaction as tr #LightBlue
component consumer as c #Yellow
component kafka as kc #LightGrey
component "schema-provider" as sp #Yellow

cl <-> sp :queries or subscribe\lto transactions
sp -> tr :sql query on\lderived state
tr <- - c :insert transactions
c <- - kc :consumes\nBalanceChanged
c - -> sp :send transaction\nfor active subscriptions


@enduml

PlantUML version 1.2019.10(Fri Sep 13 22:53:03 CEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.4+10-b304.69
Operating System: Mac OS X
Default Encoding: UTF-8
Language: en
Country: NL
--></g></svg>